# Barker Tree Services - AI Agent Instructions

## Project Overview
Next.js 15 local business website for tree services in Colfax, CA. Built with App Router, HeroUI components, and heavily optimized for AI/LLM search engines (GEO - Generative Engine Optimization).

**Tech Stack**: Next.js 15.5.4 + React 19.1.0 + TypeScript + Tailwind CSS + HeroUI + Turbopack dev server

## Architecture & Key Patterns

### Component Structure & Server/Client Boundaries
- **Server Components (default)**: All page routes (`app/**/page.tsx`) render on server
- **Client Components (`'use client'`)**: Only interactive elements
  - `Header.tsx` - Navigation with mobile menu state
  - `ContactForm.tsx` - Form state and API submission
  - `providers.tsx` - HeroUI NextUIProvider wrapper
  - All `*Content.tsx` files in `components/` (use HeroUI client components internally)
- **Single Source of Truth**: `lib/config.ts` exports `BUSINESS_INFO`, `SERVICE_AREAS`, `SERVICES`, `DETAILED_TESTIMONIALS`

### GEO (Generative Engine Optimization) Strategy
Every component has `/* GEO: ... */` comments documenting AI/LLM optimization intent. **Never remove these** - they're architectural documentation.

**Three-Layer GEO Approach**:
1. **Schema.org Microdata** (in HTML): `itemScope`, `itemType`, `itemProp` attributes
   ```tsx
   <div itemScope itemType="https://schema.org/LocalBusiness">
     <span itemProp="name">{BUSINESS_INFO.name}</span>
   ```
   Examples: `components/HomeContent.tsx`, `components/ServicesContent.tsx`

2. **JSON-LD Schemas** (generated by `lib/schema.ts`):
   - `generateLocalBusinessSchema()` - LocalBusiness + HomeAndConstructionBusiness types
   - `generateServiceSchema()` - Individual service pages
   - `generateFAQSchema()` - FAQ structured data
   - Injected in page components via `<script type="application/ld+json">`

3. **Semantic HTML**: `<article>`, `<section>`, `<address>`, ARIA labels
   - Navigation uses `aria-current="page"` for active links
   - All buttons/links have descriptive `aria-label` attributes

### Design System (Tailwind + HeroUI)

**Custom Color Palette** (`tailwind.config.js`):
```js
charcoal: { 950: '#1a1b1c', 900: '#2b2c2e', 800: '#3d3e41' }  // Dark backgrounds
evergreen: { 400: '#4ade80', 600: '#16a34a', 700: '#15803d' }  // Primary (tree theme)
sage: { 400: '#7d8a7d' }  // Complementary accent
amber: { 600: '#d97706' }  // Warning/highlight
```

**HeroUI Component Patterns**:
- Import from `@heroui/react` (NOT `@nextui-org/react`)
- Dark theme configured via `heroui()` plugin in Tailwind config
- Typical card styling: `bg-charcoal-800/50 border border-evergreen-900/20`
- Buttons: `bg-gradient-to-r from-evergreen-600 to-evergreen-700`

**Dark Mode Only**: Site uses `className="dark"` on `<html>` - no light mode support

### Navigation Architecture (Header.tsx)
**Three-Column Desktop Layout** using HeroUI Navbar:
```tsx
<NavbarContent className="lg:basis-0 lg:grow" justify="center">  {/* Logo - left */}
<NavbarContent className="lg:basis-0 lg:grow" justify="center">  {/* Nav - center */}
<NavbarContent className="lg:basis-0 lg:grow" justify="end">     {/* CTA - right */}
```

**Navigation Data**: Single `navItems` array with `{ href, label, icon }` objects
- Desktop: Maps to `NavbarItem` with icons
- Mobile: Same array maps to `NavbarMenuItem` in hamburger menu
- Active state: `usePathname()` comparison + `aria-current="page"`

**Mobile Behavior**: Logo centers (`justify="center"`), nav collapses to `NavbarMenuToggle`, CTA button shrinks (`size="sm"`)

### State Management
**Zero global state libraries** - pure React:
- Client components use `useState` for local state (forms, mobile menu)
- `usePathname()` from `next/navigation` for active nav detection
- All business data imported directly from `lib/config.ts`

## Critical Developer Workflows

### Development
```bash
npm run dev        # Start Turbopack dev server (localhost:3000)
npm run build      # Production build
npm run start      # Serve production build locally
npm run lint       # ESLint check
```

### Deployment (Vercel)
```bash
npx vercel --prod  # Direct production deploy
```
**Required Environment Variables**:
- `RESEND_API_KEY` - Email API key (set in Vercel dashboard or via CLI)

### Contact Form Email Flow
1. User submits `ContactForm.tsx` → POST to `/api/contact`
2. `app/api/contact/route.ts` validates required fields (`name`, `phone`, `email`, `service`)
3. Resend API sends email to `jacob@barkertreeservices.com`
4. Success/error state updates form UI (`submitStatus` state)

**Local Testing**: Create `.env.local` with `RESEND_API_KEY=re_...`

**Email Template**: HTML string in `route.ts` with customer details, service requested, reply-to set to customer email

### Favicon Configuration
**Critical**: Favicons must live in `public/` directory (NOT `app/`)
- Configured via `icons` metadata in `app/layout.tsx`
- Files: `favicon.ico`, `favicon-16x16.png`, `favicon-32x32.png`, `apple-touch-icon.png`

## Project-Specific Conventions

### Import Aliases
- `@/` → project root: `@/lib/config`, `@/components/Header`

### Service Data Structure
`SERVICES` array in `lib/config.ts`:
```typescript
{
  id: 'trimming',          // URL slug for /services/[id]
  title: string,
  description: string,
  features: string[],       // Bullet points for GEO
  process: string,          // Detailed workflow
  benefits: string[],       // Customer outcomes
  equipment: string,        // Tools used (for expertise signals)
  seasonality: string       // Best timing (for GEO context)
}
```
All service pages pull from this single source - **never hardcode service details**

### Video Embedding Pattern
```tsx
<video autoPlay muted loop playsInline preload="auto">
  <source src="/3.mp4" type="video/mp4" />
</video>
```
- `autoPlay muted` - Required for browser autoplay policies
- `playsInline` - iOS compatibility
- Files stored in `public/` directory

### Metadata Generation (`lib/seo.ts`)
```typescript
generatePageMetadata({ title, description, path })
```
Returns Next.js `Metadata` object with OpenGraph, Twitter cards, keywords. Used in all `page.tsx` files.

## External Dependencies

### Resend (`resend` npm package)
- Email sending service for contact form
- Free tier: 3,000 emails/month
- From: `onboarding@resend.dev` (verified Resend domain)
- No custom domain required for basic functionality

### HeroUI (`@heroui/react`)
- React component library (fork of NextUI)
- Requires `framer-motion` peer dependency
- Theme customization via `heroui()` plugin in `tailwind.config.js`

### Heroicons (`@heroicons/react/24/outline`)
- Icon library by Tailwind creators
- Using outline variant for consistency

### Lucide React (`lucide-react`)
- Supplementary icons (used sparingly)

## Common Pitfalls & Guard Rails

1. **Never remove `/* GEO: */` comments** - they document critical SEO/AI optimization patterns
2. **No light mode** - site is dark-only, `<html className="dark">` is hardcoded
3. **Never modify `BUSINESS_INFO` without approval** - contains real business data (phone, address, license #)
4. **Header layout is fragile** - three-column Navbar layout uses specific `lg:basis-0 lg:grow` pattern, test mobile/desktop if changing
5. **Contact form requires API key** - won't work locally without `.env.local` containing `RESEND_API_KEY`
6. **All media goes in `public/`** - Next.js Image optimization requires public directory, no `app/` or `components/` media
7. **Schema markup is intentional** - every `itemScope`/`itemProp` serves GEO discovery, don't remove for "cleaner" code

## Key File Reference

| File | Purpose |
|------|---------|
| `lib/config.ts` | All business data, services, testimonials (single source of truth) |
| `lib/schema.ts` | JSON-LD schema generators for GEO |
| `lib/seo.ts` | Metadata generator with keyword optimization |
| `app/layout.tsx` | Root layout, global metadata, favicon config, dark mode |
| `app/api/contact/route.ts` | Contact form email endpoint (Resend integration) |
| `components/Header.tsx` | Complex responsive three-column navigation |
| `components/ContactForm.tsx` | Form validation, submission, success/error states |
| `tailwind.config.js` | Custom color system (charcoal/evergreen/sage), HeroUI theme |

## Pre-Deployment Checklist
1. Search for `/* GEO: */` in files you modified - verify comments are intact
2. Check `itemScope`/`itemType`/`itemProp` attributes weren't removed
3. Test responsive behavior on mobile (especially if Header changed)
4. Verify contact form works (requires API key)
5. Run `npm run build` to catch TypeScript/build errors
6. Dark mode only - verify all new components look correct in dark theme
